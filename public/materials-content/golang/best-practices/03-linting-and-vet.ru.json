{"content":"\nGo-компилятор ловит ошибки типов, но пропускает множество логических проблем: неиспользуемые результаты, подозрительные конструкции, стилистические несоответствия. Для этого нужны линтеры — инструменты статического анализа, которые проверяют код без его запуска.\n\nВ Go-экосистеме три уровня проверки: встроенный **go vet**, форматирование через **gofmt**, и комбайн **golangci-lint**, объединяющий десятки линтеров.\n\n## go vet — встроенная проверка\n\n**go vet** — часть стандартной поставки Go. Он ищет частые ошибки, которые компилятор не считает ошибками, но которые почти всегда являются багами.\n\n```\ngo vet ./...\n```\n\n### Что находит go vet\n\n**Неправильные форматные строки:**\n\n```\nx := 42\nfmt.Printf(\"значение: %s\\n\", x) // go vet: Printf format %s has arg x of wrong type int\n```\n\n**Недостижимый код:**\n\n```\nfunc example() int {\n    return 1\n    fmt.Println(\"никогда не выполнится\") // go vet: unreachable code\n}\n```\n\n**Копирование мьютекса:**\n\n```\nvar mu sync.Mutex\nmu2 := mu // go vet: assignment copies lock value\n```\n\nМьютекс нельзя копировать — копия не связана с оригиналом, и блокировка не будет работать.\n\n**go vet** — минимальный уровень проверки. Запускайте его всегда, он практически не даёт ложных срабатываний.\n\n## gofmt и goimports — форматирование\n\nВ Go-сообществе нет споров о стиле форматирования. Есть один стандарт, и **gofmt** его применяет автоматически. Флаг **-d** покажет различия, **-w** — применит форматирование ко всем файлам:\n\n```\ngofmt -d .\n\ngofmt -w .\n```\n\n**goimports** делает то же самое, плюс автоматически добавляет и удаляет импорты.\n\n```\ngo install golang.org/x/tools/cmd/goimports@latest\ngoimports -w .\n```\n\nНастройте редактор так, чтобы **goimports** запускался при сохранении файла. Тогда код всегда будет отформатирован, а неиспользуемые импорты — удалены.\n\n## golangci-lint — комбайн линтеров\n\n**golangci-lint** — самый популярный инструмент для Go. Он запускает десятки линтеров за один проход и работает быстро за счёт параллелизма и кэширования.\n\n### Установка\n\nУстановить можно через Homebrew (macOS) или **go install**:\n\n```\nbrew install golangci-lint\n\ngo install github.com/golangci/golangci-lint/cmd/golangci-lint@latest\n```\n\n### Запуск\n\n```\ngolangci-lint run ./...\n```\n\n### Что находят линтеры\n\n**errcheck** — пропущенная проверка ошибок:\n\n```\nos.Remove(\"/tmp/file\") // errcheck: Error return value is not checked\n```\n\nПравильно:\n\n```\nif err := os.Remove(\"/tmp/file\"); err != nil {\n    log.Printf(\"не удалось удалить файл: %v\", err)\n}\n```\n\n**staticcheck** — подозрительные конструкции:\n\n```\nif x == true { // staticcheck: should omit comparison to bool constant\n```\n\nПравильно:\n\n```\nif x {\n```\n\n**gosimple** — код, который можно упростить:\n\n```\nif err != nil {\n    return err\n} else {\n    return nil\n}\n// gosimple: should replace if/else with return err\n```\n\nПравильно:\n\n```\nreturn err\n```\n\n**ineffassign** — присваивание, которое нигде не используется:\n\n```\nx := computeValue()\nx = 10 // ineffassign: x is overwritten before its first use\n```\n\n## Конфигурация (.golangci.yml)\n\nСоздайте файл **.golangci.yml** в корне проекта, чтобы настроить набор линтеров и исключения.\n\n```\nlinters:\n  enable:\n    - errcheck\n    - staticcheck\n    - gosimple\n    - govet\n    - ineffassign\n    - unused\n    - bodyclose\n    - gocritic\n    - gosec\n    - prealloc\n\nlinters-settings:\n  errcheck:\n    check-type-assertions: true\n  gocritic:\n    enabled-tags:\n      - diagnostic\n      - style\n      - performance\n\nissues:\n  exclude-dirs:\n    - vendor\n    - generated\n```\n\nНачните с небольшого набора линтеров и постепенно добавляйте новые. Включить всё сразу на существующем проекте — получить тысячи предупреждений и бросить линтинг.\n\n## Интеграция в CI/CD\n\nЛинтер приносит максимальную пользу, когда запускается автоматически при каждом коммите. Пример конфигурации для GitHub Actions:\n\n```\nname: lint\non: [push, pull_request]\n\njobs:\n  golangci:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-go@v5\n        with:\n          go-version: \"1.22\"\n      - name: golangci-lint\n        uses: golangci/golangci-lint-action@v4\n        with:\n          version: latest\n```\n\nЕсли линтер запускается только локально, кто-нибудь обязательно забудет. В CI он работает как строгий ревьювер, которого не обойти.\n\n## Итог\n\nТри уровня проверки: **go vet** (минимум, встроен), **gofmt/goimports** (форматирование), **golangci-lint** (полная проверка). Настройте **goimports** на сохранении в редакторе, а **golangci-lint** — в CI. **Линтер находит баги до того, как их найдут пользователи.**\n"}