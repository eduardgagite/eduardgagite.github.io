{"content":"\nGo умеет компилировать программу для **любой** операционной системы и архитектуры, даже если вы работаете на другой. Сидите на macOS? Легко соберете бинарник для Linux. Это называется **кросс-компиляция**.\n\n## Кросс-компиляция\n\nВсё управляется двумя переменными окружения:\n- **GOOS** — целевая операционная система (linux, darwin, windows).\n- **GOARCH** — целевая архитектура процессора (amd64, arm64).\n\n### Примеры\n\n```bash\n# Для Linux (стандартные серверы)\nGOOS=linux GOARCH=amd64 go build -o myapp-linux\n\n# Для macOS (Apple Silicon)\nGOOS=darwin GOARCH=arm64 go build -o myapp-mac\n\n# Для Windows\nGOOS=windows GOARCH=amd64 go build -o myapp.exe\n```\n\nВот и всё. Один файл, никаких зависимостей. Скопировал на сервер — работает.\n\n### Посмотреть все доступные платформы\n\n```bash\ngo tool dist list\n```\n\nВыведет десятки комбинаций: от `linux/amd64` до `js/wasm` (WebAssembly для браузера).\n\n## Docker\n\nВ мире Kubernetes приложение деплоят как Docker-образ. Go идеально подходит для Docker, потому что бинарник самодостаточен.\n\n### Минимальный Dockerfile\n\n```dockerfile\n# Этап 1: Сборка\nFROM golang:1.22-alpine AS builder\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\nCOPY . .\nRUN CGO_ENABLED=0 go build -ldflags \"-s -w\" -o /app/server ./cmd/api\n\n# Этап 2: Финальный образ\nFROM scratch\nCOPY --from=builder /app/server /server\nENTRYPOINT [\"/server\"]\n```\n\n### Почему FROM scratch?\n\n`scratch` — это пустой образ (0 байт). Поскольку Go-бинарник самодостаточен, нам не нужны ни Ubuntu, ни Alpine, ни bash. Итоговый Docker-образ будет весить **10-20 МБ** вместо сотен мегабайт.\n\n`CGO_ENABLED=0` отключает использование C-библиотек, что позволяет бинарнику работать в пустом контейнере.\n\n### Если нужен Alpine\n\nИногда нужны сертификаты (для HTTPS) или временные зоны:\n\n```dockerfile\nFROM alpine:3.19\nRUN apk --no-cache add ca-certificates tzdata\nCOPY --from=builder /app/server /server\nENTRYPOINT [\"/server\"]\n```\n\n## Автоматизация релизов с GoReleaser\n\n**GoReleaser** — инструмент, который собирает бинарники для всех платформ, создает архивы и публикует GitHub Release за одну команду.\n\n### Установка\n\n```bash\ngo install github.com/goreleaser/goreleaser@latest\n```\n\n### Конфигурация (.goreleaser.yml)\n\n```yaml\nbuilds:\n  - main: ./cmd/api\n    goos:\n      - linux\n      - darwin\n      - windows\n    goarch:\n      - amd64\n      - arm64\n\narchives:\n  - format: tar.gz\n    name_template: \"{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}\"\n```\n\n### Выпуск релиза\n\n```bash\ngit tag v1.0.0\ngit push origin v1.0.0\ngoreleaser release\n```\n\nGoReleaser соберет бинарники для 6 платформ (3 ОС * 2 архитектуры), упакует в архивы и опубликует на GitHub Releases.\n\n## Итог\n\n1. Кросс-компиляция: `GOOS=linux GOARCH=amd64 go build`.\n2. Docker: используйте multi-stage build с `FROM scratch` для минимального образа.\n3. `CGO_ENABLED=0` — для полностью статического бинарника.\n4. GoReleaser — автоматизация сборки и публикации для всех платформ.\n"}