{"content":"\nКак мы выяснили, хранить пароли в коде или Dockerfile — нельзя.\nМы используем переменные окружения (**-e DB_PASS=...**). Но есть нюанс.\n\n## Проблема переменных окружения\n\nЛюбой, кто имеет доступ к серверу и может сделать **docker inspect my-container**, увидит все ваши пароли в открытом виде в секции **Env**.\nКроме того, переменные окружения часто попадают в логи ошибок.\n\n## Docker Secrets (для Docker Swarm / Kubernetes)\n\nЕсли вы используете оркестраторы, там есть механизм **Secrets**. Секрет монтируется как файл в оперативную память (**/run/secrets/my_db_pass**). Это безопасно.\n\n## Безопасность в обычном Docker (локально / один сервер)\n\nЕсли вы просто запускаете контейнеры на VPS:\n1. Используйте **.env** файл, который добавлен в **.gitignore** (чтобы не утек в репозиторий).\n2. Ограничьте доступ к серверу (SSH только по ключам).\n3. Ограничьте доступ к докер-сокету (чтобы никто лишний не мог сделать **docker inspect**).\n\n## Не запекайте секреты в образ!\n\n**Плохой Dockerfile:**\n```\nENV DB_PASSWORD=secret123\n```\n\nЕсли вам нужен секрет **во время сборки** (например, токен для скачивания приватных npm-пакетов), используйте **Docker Build Secrets** (BuildKit).\n\n```\nRUN --mount=type=secret,id=npmrc \\\n    cp /run/secrets/npmrc .npmrc && npm install\n```\n\nЗапуск сборки:\n```\ndocker build --secret id=npmrc,src=./.npmrc .\n```\nВ этом случае секрет «подмонтируется» только на время выполнения команды **RUN** и не сохранится в итоговом образе.\n\n## Итого\n\n- Пароли в **.env** (не в Dockerfile!).\n- Если собираете образ с приватными ключами — используйте **--mount=type=secret**.\n"}