{"content":"\nЧто должно произойти, если ваше приложение упало с ошибкой? Или если сервер перезагрузился?\nЗа это отвечает параметр `restart`.\n\n## Варианты политик\n\n```yaml\nservices:\n  my-app:\n    image: my-image\n    restart: always # <-- Вот здесь\n```\n\n### 1. `no` (по умолчанию)\nНикогда не перезапускать. Если упало — пусть лежит.\nПолезно для \"одноразовых\" задач (скрипты миграций, бэкапы).\n\n### 2. `always`\nВсегда перезапускать.\n- Если процесс упал с ошибкой -> перезапуск.\n- Если вы остановили Docker -> при старте Docker контейнер запустится сам.\n- **Нюанс:** Если вы явно сделали `docker stop`, он не перезапустится, пока вы не сделаете `docker start`.\n\n### 3. `on-failure`\nПерезапускать, только если приложение упало с ошибкой (exit code != 0).\nЕсли приложение завершилось штатно (exit code 0), перезапуска не будет.\nПолезно, если падение — это баг, который надо лечить рестартом, а штатное завершение — это норма.\n\n### 4. `unless-stopped`\nПохоже на `always`, но с отличием: если контейнер был остановлен (вручную или по ошибке) **перед** перезагрузкой демона Docker, то после перезагрузки он **не** запустится автоматически.\nЭто самый частый выбор для долгоживущих сервисов в продакшене.\n\n## Итого\n\nДля веб-серверов и баз данных ставьте `restart: always` или `restart: unless-stopped`.\nЭто обеспечит их автоматическое поднятие после перезагрузки сервера.\n\n"}