---
title: "Лимиты ресурсов (CPU, Memory)"
category: "docker"
categoryTitle: "Docker"
section: "security"
sectionTitle: "Безопасность"
sectionOrder: 9
order: 2
---

Что будет, если в вашем приложении утечка памяти? Оно съест всю оперативку сервера.
Linux начнет убивать процессы (OOM Killer), и под раздачу может попасть не виновник, а база данных или SSH-демон. Сервер "умрет".

Docker позволяет жестко ограничить аппетиты контейнеров.

## Ограничение памяти

```bash
# Жесткий лимит: 512 МБ
docker run -d --memory="512m" nginx
```
Если Nginx попытается потребить 513 МБ, ядро Linux мгновенно убьет этот контейнер (OOM Killed), но остальная система не пострадает.

## Ограничение CPU

```bash
# Дать контейнеру не более 50% от одного ядра
docker run -d --cpus="0.5" nginx
```

## Настройка в Docker Compose

В `docker-compose.yml` (версия 3+) это делается в секции `deploy`:

```yaml
services:
  web:
    image: nginx
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 512M
        reservations: # Гарантированный минимум
          cpus: '0.25'
          memory: 128M
```

*Примечание: для применения секции `deploy` в обычном `docker-compose` (не Swarm) может потребоваться флаг `--compatibility`, хотя в современных версиях V2 это часто работает из коробки.*

## Итого

Всегда ставьте лимиты памяти (`memory`) для Java и Node.js приложений. Они любят потреблять всё доступное пространство. Лимиты спасут ваш сервер от полного зависания.

