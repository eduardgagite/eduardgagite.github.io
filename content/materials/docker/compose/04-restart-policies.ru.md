---
title: "Политики перезапуска (restart policies)"
category: "docker"
categoryTitle: "Docker"
section: "compose"
sectionTitle: "Docker Compose"
sectionOrder: 7
order: 4
---

Что должно произойти, если ваше приложение упало с ошибкой? Или если сервер перезагрузился?
За это отвечает параметр **restart**.

## Варианты политик

```
services:
  my-app:
    image: my-image
    restart: always
```

### 1. **no** (по умолчанию)
Никогда не перезапускать. Если упало — пусть лежит.
Полезно для "одноразовых" задач (скрипты миграций, бэкапы).

### 2. **always**
Всегда перезапускать.
- Если процесс упал с ошибкой -> перезапуск.
- Если вы остановили Docker -> при старте Docker контейнер запустится сам.
- **Нюанс:** Если вы явно сделали **docker stop**, он не перезапустится, пока вы не сделаете **docker start**.

### 3. **on-failure**
Перезапускать, только если приложение упало с ошибкой (exit code != 0).
Если приложение завершилось штатно (exit code 0), перезапуска не будет.
Полезно, если падение — это баг, который надо лечить рестартом, а штатное завершение — это норма.

### 4. **unless-stopped**
Похоже на **always**, но с отличием: если контейнер был остановлен (вручную или по ошибке) **перед** перезагрузкой демона Docker, то после перезагрузки он **не** запустится автоматически.
Это самый частый выбор для долгоживущих сервисов в продакшене.

## Итого

Для веб-серверов и баз данных ставьте **restart: always** или **restart: unless-stopped**.
Это обеспечит их автоматическое поднятие после перезагрузки сервера.
