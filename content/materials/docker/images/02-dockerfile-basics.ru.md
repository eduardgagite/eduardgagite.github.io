---
title: "Основы Dockerfile: FROM, COPY, RUN, CMD"
category: "docker"
categoryTitle: "Docker"
section: "images"
sectionTitle: "Dockerfile и сборка образов"
sectionOrder: 4
order: 2
---

Чтобы создать свой образ, нам нужна инструкция. Эта инструкция пишется в файле с названием `Dockerfile` (без расширения).

Давайте напишем Dockerfile для простого Node.js приложения.

## Пример Dockerfile

```dockerfile
# 1. Базовый образ
FROM node:18-alpine

# 2. Рабочая директория внутри контейнера
WORKDIR /app

# 3. Копируем файлы зависимостей
COPY package.json package-lock.json ./

# 4. Устанавливаем зависимости
RUN npm ci

# 5. Копируем исходный код
COPY . .

# 6. Объявляем порт (информативно)
EXPOSE 3000

# 7. Команда запуска
CMD ["node", "index.js"]
```

## Разбор команд

### FROM
С чего начинаем. Всегда первая команда.
`FROM ubuntu:22.04` или `FROM python:3.9-slim`.

### WORKDIR
Задает текущую папку внутри контейнера.
Все последующие команды (`COPY`, `RUN`, `CMD`) будут выполняться в ней.
Если папки нет, она создастся.
**Совет:** Всегда используйте `WORKDIR`, не работайте в корне `/`.

### COPY
Копирует файлы **с вашего компьютера** (хоста) **в контейнер**.
Синтаксис: `COPY <откуда> <куда>`.
`COPY . .` означает "скопировать всё из текущей папки проекта в текущую папку контейнера (`WORKDIR`)".

### RUN
Выполняет команду **во время сборки** образа.
Результат выполнения сохраняется в слое образа.
Используется для установки пакетов (`npm install`, `pip install`, `apt-get update`).

### CMD
Команда, которая выполнится **при запуске контейнера** (`docker run`).
В Dockerfile может быть только одна инструкция `CMD` (точнее, сработает только последняя).

## Как собрать образ

Когда Dockerfile готов, мы запускаем сборку командой `build`:

```bash
# -t my-app: ставим тег (имя) образу
# . : путь к папке с Dockerfile (текущая папка)
docker build -t my-app .
```

Docker прочитает файл сверху вниз, выполнит каждую инструкцию и создаст итоговый образ `my-app`.

## Итого

1. `FROM` — база.
2. `WORKDIR` — перешли в папку.
3. `COPY` — закинули файлы.
4. `RUN` — установили библиотеки.
5. `CMD` — сказали, как запускать.

