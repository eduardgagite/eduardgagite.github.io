---
title: "Бэкап, восстановление и перенос данных volumes"
category: "docker"
categoryTitle: "Docker"
section: "storage"
sectionTitle: "Хранение данных"
sectionOrder: 5
order: 3
---

Вы используете Volumes. Это круто. Но как сделать бэкап?
Ведь том — это не просто папка, в которую можно зайти проводником (особенно на Mac/Windows).

Docker-way решение: использовать временный контейнер-утилиту.

## Создание бэкапа

Задача: Заархивировать содержимое тома **my-data** в файл **backup.tar.gz** в текущей папке.

```
docker run --rm \
  -v my-data:/source \
  -v $(pwd):/backup \
  alpine \
  tar czf /backup/backup.tar.gz -C /source .
```

Разберем эту магию:
1. **docker run --rm**: Запустить и сразу удалить контейнер после завершения.
2. **-v my-data:/source**: Подключили наш том c данными в папку **/source** внутри контейнера.
3. **-v $(pwd):/backup**: Подключили текущую папку хоста в папку **/backup** внутри контейнера.
4. **alpine**: Используем самый легкий образ.
5. **tar ...**: Команда архивации. Берет файлы из **/source** и кладет архив в **/backup**.

В итоге у вас на компьютере появляется файл **backup.tar.gz**.

## Восстановление из бэкапа

Задача: Распаковать **backup.tar.gz** в новый том **restored-data**.

1. Создаем пустой том:

```
docker volume create restored-data
```

2. Запускаем распаковку:

```
docker run --rm \
  -v restored-data:/dest \
  -v $(pwd):/backup \
  alpine \
  tar xzf /backup/backup.tar.gz -C /dest
```

Логика та же: монтируем том и папку с бэкапом, но теперь выполняем команду распаковки (**tar x...**).

## Зачем это нужно?

- Перенос данных с локальной машины на сервер (сделали tar -> scp на сервер -> распаковали).
- Регулярные бэкапы перед обновлением базы данных.
- Переезд на другую машину.

## Итого

Не бойтесь того, что данные "спрятаны" в Volume. С помощью маленького контейнера Alpine вы всегда можете добраться до них, заархивировать и перенести куда угодно.
