---
title: "Стратегия тегирования: semver, sha"
category: "docker"
categoryTitle: "Docker"
section: "registry"
sectionTitle: "Реестры и доставка"
sectionOrder: 8
order: 2
---

Как правильно называть версии образов?
Если вы всегда используете **latest**, вы стреляете себе в ногу.

## Проблема тега **latest**

**latest** — это просто тег по умолчанию. Это **НЕ** "самая свежая версия". Это просто строка "latest".
Если вы обновили код, собрали образ, но забыли перевесить тег **latest**, то **docker pull my-app:latest** скачает старый код.

Кроме того, если в продакшене вы используете **image: my-app:latest**, вы не знаете, какая именно версия кода там сейчас работает. Откатиться на предыдущую невозможно (ведь она тоже была **latest**, вы просто перезаписали её).

## Стратегия 1: Semantic Versioning (SemVer)

Выпускаете релизы, как в npm или git tag: **v1.0.0**, **v1.0.1**, **v1.1.0**.

```
docker build -t my-app:v1.0.1 .
```

**Плюсы:** Понятно людям. Легко откатиться (**v1.0.1** сломалась -> запустили **v1.0.0**).
**Минусы:** Нужно вручную следить за версиями.

## Стратегия 2: Git Commit SHA

Автоматическая генерация тега на основе хеша коммита.

```
docker build -t my-app:$(git rev-parse --short HEAD) .
```

**Плюсы:** Железобетонная связка "Код в Git" <-> "Образ в Docker". Вы точно знаете, из какого коммита собран этот образ. Идеально для CI/CD.
**Минусы:** Теги выглядят как набор букв (**a1b2c3d**), сложно понять, какой новее, без просмотра истории git.

## Лучшая практика (Комбинированный подход)

При релизе вешать сразу несколько тегов на один и тот же образ:

1. Точный хеш: **my-app:a1b2c3d** (для роботов и точного отката).
2. Версия: **my-app:v1.2** (для людей).
3. Плавающий тег: **my-app:latest** (для удобства локального запуска).

В Docker один и тот же Image ID может иметь сколько угодно тегов. Это бесплатно (место на диске не дублируется).

## Итого

В продакшене **никогда** не используйте **latest**. Всегда фиксируйте версию (**v1.2.3**) или хеш коммита. Это единственный способ обеспечить предсказуемость и возможность отката (Rollback).
