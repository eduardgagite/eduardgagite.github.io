---
title: "Публикация портов (-p) и доступность"
category: "docker"
categoryTitle: "Docker"
section: "networking"
sectionTitle: "Сети"
sectionOrder: 6
order: 1
---

Контейнеры по умолчанию живут в своей закрытой сети. Если вы запустите веб-сервер внутри контейнера, снаружи (из вашего браузера) он будет недоступен.
Чтобы «пробить дыру» в этой изоляции, мы используем публикацию портов (Port Publishing).

## Флаг -p (publish)

Синтаксис: `-p <ПОРТ_НА_ХОСТЕ>:<ПОРТ_В_КОНТЕЙНЕРЕ>`

```bash
docker run -d -p 8080:80 nginx
```
Здесь мы говорим: "Всё, что придет на порт `8080` моего ноутбука, перенаправь на порт `80` внутри контейнера Nginx".

Теперь сайт доступен по адресу `http://localhost:8080`.

## Важные нюансы

1. **Конфликт портов:**
   Если вы запустите два контейнера с `-p 8080:80`, второй упадет с ошибкой `Bind for 0.0.0.0:8080 failed: port is already allocated`.
   Один порт на хосте может слушать только один процесс.
   **Решение:** Поменяйте внешний порт для второго контейнера: `-p 8081:80`.

2. **UDP протокол:**
   По умолчанию пробрасывается TCP. Если нужен UDP (например, для DNS или игровых серверов), укажите это явно:
   ```bash
   docker run -d -p 53:53/udp my-dns-server
   ```

3. **Случайный порт (-P):**
   Если вам лень выбирать свободный порт, можно использовать флаг `-P` (заглавная). Docker сам найдет свободный порт на хосте и привяжет его ко всем `EXPOSE` портам контейнера.
   Узнать, какой порт он выбрал, можно через `docker port <container_name>`.

## Доступность (0.0.0.0 vs 127.0.0.1)

По умолчанию `-p 8080:80` открывает порт на адресе `0.0.0.0`. Это значит, что сервис будет доступен **всему интернету** (если у вас "белый" IP).

Если вы хотите, чтобы сервис был доступен **только с вашего компьютера** (для безопасности), указывайте IP явно:

```bash
# Доступен только локально
docker run -p 127.0.0.1:8080:80 nginx
```

## Итого

Без флага `-p` ваш контейнер — как подводная лодка: внутри всё работает, но снаружи к нему не подключиться. Всегда проверяйте маппинг портов командой `docker ps`.

