---
title: "Сетевая безопасность и TLS"
category: "redis"
categoryTitle: "Redis"
section: "security"
sectionTitle: "Безопасность"
sectionOrder: 9
order: 3
---

Даже при правильных паролях и ACL Redis остаётся уязвимым, если его можно перехватить по сети: трафик без шифрования легко читать и подменять. Поэтому в продакшене важно одновременно ограничить сеть и, при необходимости, включить **TLS**.

Практически это сводится к трём шагам: изоляция по сети, защита порта Redis и настройка шифрования.

## Изоляция по сети

Первая линия защиты — не выпускать Redis в открытый мир.

Типичные приёмы:

- помещать Redis в приватную подсеть;
- разрешать к нему доступ только с адресов приложений;
- закрывать внешний порт на уровне firewall.

Пример грубой, но показательной настройки firewall на сервере:

```
iptables -A INPUT -p tcp --dport 6379 -s 10.0.0.0/24 -j ACCEPT
iptables -A INPUT -p tcp --dport 6379 -j DROP
```

Здесь 6379 открыт только для подсети 10.0.0.0/24. Остальные подключения режутся ещё до попадания в Redis.

В оркестраторах вроде Kubernetes те же правила реализуются через NetworkPolicy и настройки сервисов.

## Включение TLS на стороне Redis

Начиная с современных версий, Redis умеет принимать TLS‑подключения напрямую.

В конфиге:

```
port 0
tls-port 6379

tls-cert-file /etc/redis/tls/redis.crt
tls-key-file /etc/redis/tls/redis.key
tls-ca-cert-file /etc/redis/tls/ca.crt
```

Здесь:

- port 0 — отключаем нешифрованный порт;
- tls-port 6379 — включаем порт только под TLS;
- tls-cert-file, tls-key-file, tls-ca-cert-file — путь к сертификату, ключу и корневому сертификату.

После этого клиенты должны подключаться с поддержкой TLS:

```
redis-cli -h my-redis-host -p 6379 --tls \
  --cert /etc/redis/tls/client.crt \
  --key /etc/redis/tls/client.key \
  --cacert /etc/redis/tls/ca.crt
```

В бою сертификаты обычно выдаются через корпоративный PKI или автоматизированные системы вроде cert-manager.

## TLS через прокси

Если по каким‑то причинам нет возможности собрать Redis с поддержкой TLS, можно использовать внешний прокси.

Идея:

- Redis слушает только на локальном адресе без TLS;
- снаружи доступен только прокси (например, stunnel, Envoy, Nginx‑стрим), который принимает TLS и прокидывает трафик внутрь.

Схема:

- приложение → TLS → прокси → plain‑TCP → Redis.

Плюсы:

- не нужно трогать конфиг Redis;
- проще унифицировать шифрование для нескольких сервисов;
- сертификатами управляет один слой.

Минусы:

- дополнительный компонент в инфраструктуре;
- важно следить за его отказоустойчивостью и масштабированием.

## Итог

Сетевая безопасность в **Redis** начинается с изоляции по сети и правильного bind, а завершается шифрованием трафика через TLS либо на самом Redis, либо через внешний прокси.

Если не выпускать порт Redis в интернет, ограничивать список клиентов и шифровать соединения между датацентрами и внешними сервисами, риск перехвата и подмены данных заметно снижается.


