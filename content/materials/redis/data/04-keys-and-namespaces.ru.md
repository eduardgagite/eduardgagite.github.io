---
title: "Работа с ключами и пространством имен"
category: "redis"
categoryTitle: "Redis"
section: "data"
sectionTitle: "Структуры данных"
sectionOrder: 2
order: 4
---

Работа с ключами в Redis важна не меньше, чем выбор структуры данных. От того, как называются ключи, зависит удобство отладки, простота поиска и риск случайно удалить или перезаписать чужие данные.

## Что такое ключ в Redis

Ключ в Redis — это строка, по которой сервер находит значение. В одном экземпляре Redis все ключи лежат в общем пространстве. Никаких таблиц или схем, как в классических базах, здесь нет.

Простейший пример записи значения по ключу:

```
SET user:1 "Alice"
GET user:1
```

Ключи могут быть любыми строками, но на практике используют понятные имена, которые отражают назначение данных.

## Пространства имён через разделитель

Так как формальных схем нет, пространство имён организуют самим названием ключа. Часто используют двоеточие как разделитель.

Пример ключей для пользователей:

```
SET user:1:name "Alice"
SET user:1:email "alice@example.com"
SET user:2:name "Bob"
```

Здесь user — логическая группа, число после двоеточия — идентификатор, а последнее слово — поле или тип данных.

Ещё один пример для сессий и кэша:

```
SET session:token:abc123 "user:1"
SET cache:article:42 "html..."
```

Такой подход помогает:

**Визуально группировать данные.** По ключу сразу видно, к чему относится запись.

**Избегать конфликтов.** Ключи разных подсистем не пересекаются: session:..., cache:..., user:....

**Удобно искать и чистить.** Можно выбрать группу ключей по шаблону.

## Поиск и обход ключей

Для поиска ключей по шаблону есть несколько команд. В учебных примерах часто используют KEYS, но в реальных проектах её лучше избегать: она может блокировать сервер, если ключей много.

Пример KEYS для понимания работы шаблонов:

```
KEYS user:*
```

Более безопасный вариант для продакшена — команда SCAN. Она обходит ключи постепенно и не блокирует сервер.

Пример выборки сессий по шаблону:

```
SCAN 0 MATCH session:* COUNT 100
```

Клиент вызывает SCAN несколько раз, пока не обойдёт все подходящие ключи.

## Тип ключа и удаление

Иногда важно понять, какое значение лежит по ключу. Для этого есть команда TYPE.

```
TYPE user:1
```

Ответ покажет тип: string, hash, list, set и так далее.

Удалить ключ можно простой командой:

```
DEL user:1
```

Если ключ крупный и его много, иногда используют UNLINK. Эта команда помечает данные на удаление и возвращается быстрее, чем DEL.

```
UNLINK big:list
```

Какую бы команду ни использовать, важно аккуратно выбирать ключи. Ошибка в шаблоне или названии может удалить лишние данные.

## Практические схемы именования

Несколько типичных вариантов, которые хорошо приживаются в проектах.

Пользователи:

```
user:42
user:42:name
user:42:settings
```

Сессии и авторизация:

```
session:token:abc123
session:user:42
```

Кэш:

```
cache:article:10
cache:profile:42
```

Счётчики и метрики:

```
metrics:views:article:10
metrics:logins:2025-11-20
```

Главная идея простая: один логический блок — один префикс. Так ключи остаются читаемыми, их легко искать и удалять по шаблону, а риск конфликтов между разными частями системы заметно снижается.
